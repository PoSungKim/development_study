# CQRS (Command Query Responsibility Segregation)
> 명령 모델과 조회 모델, CQRS 장단점
* 

<hr>
<br>

## 단일 모델의 단점
#### 단일 모델 구조에서 발생하는 어려움을 해결하고자 CQRS로 이어지는 흐름

<br>

<div align="center">
    <img width="50%" src="https://user-images.githubusercontent.com/37537227/196080618-daded9e0-a88d-4f73-b911-c3c1399c2dd7.png">
</div>

<br>

### 상태 변경 vs 조회
* 객체 지향으로 도메인 모델을 구현할 때 주로 사용하는 ORM 기법은 도메인 상태 변경 기능을 구현하는 데는 적합
* 다만, 조회 기능처럼 여러 애그리거트에서 데이터를 가져와 출력하는 기능을 구현하기에는 부적합

<br>

### 조회 기능 방법
* 식별자를 이용한 애그리거트 참조 방식
  * 즉시 로딩 (Eager Loading) 사용 불가능
* 애그리거트 직접 참조하는 방식
  * 즉시 로딩 (Eager Loading), 지연 로딩 (Lazy Loading) 고민 필요
* JPA Native Query
  * DBMS 전용 기능 사용 가능

<br>

### 조회 기능의 방식의 복잡도 높아지면서 구현의 복잡도도 높아지는 고민 발생
* 상태변경 모델과 조회 모델의 분리 필요 --> CQRS

<br>
<hr>
<br>

## CQRS
#### 단일 모델을 사용할 때 발생하는 복잡도를 해결하기 위해 CQRS 사용

<br>

<div align="center">
    <img width="50%" src="https://user-images.githubusercontent.com/37537227/196080741-83da03a4-a9b3-40d2-b8e7-328e26c898ff.png">
</div>

<br>

### 상태 변경의 대상 (1 Agg) vs 상태 조회의 대상 (N Aggs)
* 상태 변경 - Command를 위한 모델
* 상태 조회 - Query를 위한 모델

<br>
<hr>
<br>
