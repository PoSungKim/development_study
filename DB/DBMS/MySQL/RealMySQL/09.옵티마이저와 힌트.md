# 옵티마이저와 힌트
> 쿼리를 최적으로 실행하기 위해 각 테이블의 데이터가 어떤 분포로 저장돼 있는지 통계 정보를 참조하여, 그러한 기본 데이터를 비교해 최적의 실행 계획을 수립하는 작업 필요
* `Explain` 명령어로 쿼리의 실행 계획 확인 가능

<hr>
<br>

## 개요
#### 실행 계획을 수립하는 옵티마이저를 이해하는 것이 중요하며, 실행 계획을 이해해야지 더 최적화된 방법으로 실행 계획을 수립하도록 유도 가능

<br>

### 쿼리 실행 절차
* SQL Parsing --> SQL Parse Tree (MySQL 엔진)
* Optimizer --> Execution Plan (MySQL 엔진)
* Record Extract (MySQL 엔진 + 스토리지 엔진)

<br>

### 옵티마이저 종류
* CBO (Cost-based Optimizer)
* RBO (Rule-based Optimizer)

<br>
<hr>
<br>

## 기본 데이터 처리
#### 

<br>

### 풀 테이블 스캔과 풀 인덱스 스캔
* 풀 테이블 스캔 사용하는 경우
  * 레코드 건수가 너무 작을 때
  * WHERE 절이나 ON 절에 인덱스를 이용이 적절하지 않을 경우
  * 인덱스 레인지 스캔 사용 가능 쿼리라도, 레코드 건수가 너무 많은 경우
* 풀 인덱스 스캔 사용하는 경우
  ```mysql
  SELECT COUNT(*) FROM employees;
  ```
<br>

### 병렬 처리
```mysql
SET SESSION innodb_parallel_read_threads=8;
SELECT COUNT(*) FROM salaries;
```
* MySQL 8.0에서 병렬 처리를 사용하기 위해서는 WHERE 절에 아무것도 없어야 함
* CPU의 코어 개수를 넘는 설정 X

<br>

### Order By 처리 (Using filesort)
* 인덱스 이용 vs FileSort 이용
  * 인덱스를 사용하지 못하는 경우
    * 정렬 기준이 너무 많아서 요건별로 모두 인덱스 생성하는 것이 불가능할 경우
    * Group by 혹은 Distinct 결과를 정렬해야 하는 경우
    * Union의 결과 같이 임시 테이블의 결과를 다시 정렬해야 하는 경우
    * 랜던하게 결과 레코드를 가져와야 하는 경우

<br>
<hr>
<br>

