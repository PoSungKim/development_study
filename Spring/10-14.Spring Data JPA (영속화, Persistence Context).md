# 영속화, Persistence Context
> Persistence Context에서 가장 주체가 되는 객체는 Entity Manager 
* Entity Manager는 중간 중간 JPA 결과들을 매니징하여 DB에 반영하는 역할을 수행하는 주요 객체, 즉 Entity와 DB Table을 반영해주는 객체

<hr>
<br>

## Spring Boot Persistence Context 설정
#### persistence.xml 파일 설정은 Spring Boot가 알아서 해준다

<br>

### [build.gradle]
```gradle
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
}
```
* Spring Boot 전에는 /src/main/resources/META-INF/persistence.xml 파일에 Persistence 관련 설정을 진행해야 했다
* Spring Boot에서는 /src/main/resources/application.yml 파일에 spring.jpa.**을 통해 보다 간단하고 짧게 설정 가능해졌다

<br>
<hr>
<br>

## DB 적용 != EntityManager Cache 적용
#### EntityManager는 중간 결과 값들을 Map <ID, Entitnty> 형태로 저장하여 모든 로직이 끝난 이후에 DB에 반영
#### 중간 결과 값을 Cache에 저장한다는 점은 Cache 내용과 DB 내용이 항상 동일하지는 않다는 것을 의미

<br>

### [@Transactional, DAO.flush()]
```java
@Transactional
public void method() {
    DAO.logic();
    DAO.flush();
    
    DAO.logic();
    DAO.flush();
}
```
* @Transactional
  * 로직이 모두 끝난 이후에 Commit 
  * 상위 클라스에 @Transactional이 있으면, 하위 클라스의 @Transactional은 상위 클라스의 @Transactional을 따라간다
* DAO.flush()
  * 로직이 중간에 Commit

<br>
<hr>
<br>

## Entity LifeCycle
#### 

<br>

##
####

<br>

### [Entity 상태 전이]
* transient
* persistent
* detached
* removed
* CascadeType.* 

<br>
<hr>
<br>
