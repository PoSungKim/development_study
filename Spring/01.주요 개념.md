# 주요 개념 
> 국가 표준프레임워크

* 방대한 기능이 제공되며, 그만큼 안정적이기 때문에, 배우는 것이 필수
* ORM vs SQL Mapper, JPA [Hibernate] vs MyBatis, JPA [Hibernate], (dto, vo) vs MyBatis (DAO), oom vs erd

<hr>
<br>


## 1. ORM (Object-Relational Mapping)

#### [참고 자료](https://victorydntmd.tistory.com/m/195)

<div align="center">
    <img width="1179" alt="스크린샷 2021-05-01 오후 9 00 25" src="https://user-images.githubusercontent.com/37537227/116781790-44399800-aac0-11eb-8f8f-cd97ad963efb.png">
</div>

``` bash
ORM : 객체와 데이터베이스 간의 관계를 매핑한다는 개념
```
<br>

### [ORM을 구현하는 방법: JPA (Java Persistence API)]

<br>

<div align="center">
	<img height="300" width="330" alt="스크린샷 2021-05-01 오후 9 19 34" src="https://user-images.githubusercontent.com/37537227/116782252-f1adab00-aac2-11eb-802e-c815a02b8e4b.png">
	<img height="300" width="330" alt="스크린샷 2021-05-01 오후 9 21 23" src="https://user-images.githubusercontent.com/37537227/116782307-30dbfc00-aac3-11eb-8d0f-ce94ccfe0221.png">
	<img height="300" width="330" alt="스크린샷 2021-05-01 오후 9 22 50" src="https://user-images.githubusercontent.com/37537227/116782334-64b72180-aac3-11eb-948c-33376088f0e7.png">
</div>

<br>

<div align="center">

</div>


```bash
JPA - ORM 구현을 위한 기본 인터페이스
Hibernate - 인터페이스를 실제 구현한 클래스들
Spring Data JPA - Hibernate 클래스들 중에서도 주요 클래스들 
```

<br>

### [Lombok]

``` java
@Getter
@Setter
@ToString
@NoArgsConstructor
@AllArgsConstructor
@RequiredArgsConstructor
@Data
@Builder
@ToString
public class [class명] {
    @NonNull
    private [데이터타입][멤버변수]    
}
```
* Class명 위에서 한 번만 선언하는 방법 (추천)
* ```@ToString```은 모든 Classs는 Object를 상속받는데, toString() 함수의 리턴값이 원하는 방향이랑 다르기 때문에, Spring에서도 공식적으로 Override해서 사용하라고 권고한다.
	* 따라서, 보통 우리가 바라는 결과값, Class 명과 안의 멤버 변수 값이 어떻게 구성되어 있는지 확인하는 toString() 함수로 변환시켜주는 것이 ```@ToString``` annotation이다. 
* ```@Data``` = ```@RequiredArgsConstructor``` +  ```@ToString``` + ```@EqualsAndHashCode``` + ```@Getter``` +  ```@Setter```
* ```@Builder``` : Testing 용도

<br>

``` java
public class [class명] {

    @Getter
    @Setter
    @ToString
    private string name;
}
```
* 멤버 변수마다 선언하는 방법 (비추천)

<br>

### [Terminal - DTO Testing 결과]
```java
public class InputDtoTest {
    @Test
    void test() {
        InputDto inputDto = InputDto.builder().value("testValue").build();

        System.out.println(inputDto.toString());
    }
}
```

<br>
<hr>
<br>

## 2. SQL Mapper - Hibernate (dto, vo) vs MyBatis (DAO), oom vs erd

#### [참고 자료](https://victorydntmd.tistory.com/m/195)

<div align="center">
    <img width="1179" alt="스크린샷 2021-05-01 오후 9 00 25" src="https://user-images.githubusercontent.com/37537227/116781790-44399800-aac0-11eb-8f8f-cd97ad963efb.png">
</div>

* ORM : 객체와 관계형 데이터를 매핑한다는 개념 
    *  개념으로서, 구현하는 방법으로 크게 2가지 방법이 있다 : SQL Mapper와 JPA
    *  MyBatis --> SQL Mapper 
    *  Hibernate --> ORM 


<br>
<hr>
<br>

## 3. REST 

#### (Representational State Transfer : 자원의 상태 전달) - 네트워크 아키텍처

<br>

### [조건1. 자원의 식별 - URI(Uniform Resource Identifier)]
```bash
https://foo.co.kr/user/100

Resource: user
식별자:100
```
* 구분 지을 때 Resource와 Identifier를 사용하고, 모두 URI에 포함되어 있다

<br>

### [조건2. 메세지를 통한 리소스 조작]
```bash
HTML, XML, JSON, TEXT 등의 다양한 데이터가 Web에서 공유된다
```
* HTTP Header 부분에서 content-type을 통해, 데이터 타입을 지정해줄 수 있다
* Packet의 Body 부분에 리소스를 넣을 수 있다

<br>

### [조건3. 자기서술적 메세지]
```bash
HTTP 기반의 REST에서는 HTTP Method와 Header 정보, 그리고 URI의 포함되는 정보로 표현 가능

GET    : https://foo.co.kr/user/100, 사용자의 정보 요청
POST   : https://foo.co.kr/user    , 사용자 정보 생성
PUT    : https://foo.co.kr/user    , 사용자 정보 생성 및 수정
DELETE : https://foo.co.kr/user/100, 사용자의 정보 삭제
```
* HTTP Header 부분에서 content-type을 통해, 데이터 타입을 지정해줄 수 있다
* URI에 모두 못 넣는다면, Packet의 Body 부분에 리소스를 활용할 수 있다

<br>

### [조건4. Application 상태에 대한 엔진으로써 하이퍼미디어]
```bash
Client 요청에 대한 데이터만 응답하는 것이 아니라, 관련 리소스에 대한 Link 정보까지 포함해야 한다
```
* 조건4까지는 잘 안 지켜지고 있다고 한다

<br>
<hr>
<br>

## 3. URI (Uniform Resource Identifier) 

#### URL은 URI의 하위 개념

<br>

### [URI vs URL]
```bash
URI (Uniform Resource Identifier)
인터넷에서 특정 자원을 나타내느 주소 값

https://www.foo.co.kr/resource/sample/1

URL (Uniform Resource Locator)
인터넷 상에서의 자원, 특정 파일이 어디에 위치하는지 식별 하는 주소

https://www.foo.co.kr/foo.pdf

```

<br>

### [URI 설계 원칙]
```bash
1. 슬래시 구분자 (/)는 계층 관계를 나타내는 데 사용한다
2. URI 마지막 문자로 /를 포함하지 않는다
3. 하이픈 (-)은 가독성을 높인다
4. 밑줄 (_)은 사용하지 않는다
5. URI 경로에는 소문자가 적합하다
6. 파일 확장자 (.jsp)는 URI에 포함하지 않는다
7. 프로그래밍 언어에 의존적인 확장자를 사용하지 않는다
8. 구현에 의존적인 경로를 사용하지 않는다 (servlet을 사용했다는 것을 굳이 노출할 필요가 없다)
9. Session ID를 포함하지 
10.프로그래밍 언어의 Method명을 이용하지 않는다
11.명사에 단수형 보다는 복수형을 사용해야 한다. 컬렉션에 대한 표현은 복수로 사용
12.컨트롤러 이름으로는 동사나 동사구를 사용한다
13.경로 부분 중 변하는 부분은 유일한 값으로 대체한다
14.CRUD 기능을 나타내는 것은 URI에 사용하지 않는다
15.URI Query Parameter 디자인 (?key=value)
16.URI Query는 컬렉션의 결과를 페이지로 구분하여 나타내는데 사용한다
17.API에 있어서 서브 도메인은 일관성 있게 사용해야 한다 ([서브 도메인명].foo.co.kr or [서브 도메인명]-foo.co.kr)
18.클라이언트 개발자 포탈 서브 도메인은 일관성 있게 만든다
```
* HTTP Header 부분에서 content-type을 통해, 데이터 타입을 지정해줄 수 있다
* Packet의 Body 부분에 리소스를 넣을 수 있다

<br>
<hr>
<br>

## 4. HTTP (Hyper Text Transfer Protocol)

#### HTML, XML, JSON, Image, Voice, Video, Javascript, PDF 등 다양한 컴퓨터에서 다룰 수 있는 것은 모두 전송할 수 있다
#### TCP를 기반으로 REST의 특징을 모두 구현하고 있는 Web 기반 Protocol이다

<br>

### [HTTP는 Request를 주고 Response를 받는 형태의 통신 방법]

<div align="center">

  ![스크린샷 2021-04-29 오전 12 01 53](https://user-images.githubusercontent.com/37537227/116426498-1d8c1f00-a87e-11eb-81ca-f0da3df73e21.png)

</div>

### [HTTP Status Code]
```bash
1XX : 처리 중 

2XX : 성공 

3XX : 리다이렉트

4XX : 클라이언트 에러

5XX : 서버 에러

```

<br>

### [주요 Code]

```bash
200 : 성공 

201 : 성공. 리소스 생성 성공

301 : 리다이렉트. 리소스가 다른 장소로 변경

303 : 리다이렉트. 클라이언트가 자동으로 새로운 리소스로 요청 처리

400 : 요청 오류. 파라미터 에러

401 : 권한 없음 (인증 실패)

500 : 서버 내부 에러

503 : 서비스 정리 (점검 등등)
```

<br>
<hr>
<br>

## 5. MVC Test

#### ``` @restcontroller```에  대한 테스팅 진행

<br>


### [build.gradle]

```bash
test {
	useJUnitPlatform()
}
```

* Spring에는 JUnit이 기본적으로 설치되어 있다

<br>

### [JUnit5 - ```@WebMvcTest```]

```java
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.*;

@WebMvcTest
class HelloControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    void getHello() throws Exception {
        mockMvc.perform(MockMvcRequestBuilders.get("/api/user/1"))
            .andDo(print())
            .andExpect(status().isOk())
            .andExpect(content().json("{\"value\" : \"Hello User\"}"));
    }

}
```
* Frontend 서버를 직접 구축해서 확인하는 방법도 가능하지만, JUnit을 사용해서 test 디렉토리에서 바로 바로 확인하는 방법도 있다
* ```@WebMvcTest``` : 
* ```@Autowired```  : 
* ```@Test```       : 

<br>

### [Terminal - Testing 결과]

```bash
MockHttpServletRequest:
      HTTP Method = GET
      Request URI = /api/user/1
       Parameters = {}
          Headers = []
             Body = null
    Session Attrs = {}

Handler:
             Type = com.pfm.Spring_Backend.controller.HelloController
           Method = com.pfm.Spring_Backend.controller.HelloController#getHello(int)

Async result = null

Resolved Exception:
             Type = null

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 200
    Error message = null
          Headers = [Vary:"Origin", "Access-Control-Request-Method", "Access-Control-Request-Headers", Content-Type:"application/json"]
     Content type = application/json
             Body = {"value":"Hello User"}
    Forwarded URL = null
    Redirected URL= null
          Cookies = []
```
* ```HTTP Method```, ```Request URI```, ```status```, ```Headers```, ```Content-type```, ```Body``` 등이 주요 요소들


<br>
<hr>
<br>

## 6. DI (Dependency Injection)

#### 클래스 간의 ```의존관계```를 스프링 컨테이너가 자동으로 연결해주는 현상

<br>

### [JUnit5 - ```@WebMvcTest```]

```java
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;
import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.*;

@WebMvcTest
class HelloControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    void getHello() throws Exception {
        mockMvc.perform(MockMvcRequestBuilders.get("/api/user/1"))
            .andDo(print())
            .andExpect(status().isOk())
            .andExpect(content().json("{\"value\" : \"Hello User\"}"));
    }

}
```
* Frontend 서버를 직접 구축해서 확인하는 방법도 가능하지만, JUnit을 사용해서 test 디렉토리에서 바로 바로 확인하는 방법도 있다

<br>
<hr>
<br>
