# IoC Container에 Bean 등록 및 DI 방법
> @Component, @Service, @Repository, @Controller 등등 IoC Container에서 Bean (객체) 관리를 어떻게 진행하는지 정리
* 크게 두 가지 : ComponentScan 방법 및 직접 작성 방법
  * CompoenentScan : @Service, @Repository, @Controller
  * 직접 작성 방법 : XML과 .java (@Configuration)
* [docs.spring.io >> configuration](https://docs.spring.io/spring-boot/docs/current/reference/html/using.html#using.configuration-classes)

<hr>
<br>

## @Configuration
#### 과거에는 Bean 관리를 XML로 진행했지만, 최근에는 Spring.io 공식 문서에 따르면 @Configuration을 이용하는 것을 추천한다고 함
#### 이렇게 IoC에 등록된 Beans들에 대한 Dependency Injection 시, `Constructor Injection`을 추천한다고 함

<br>

### [Application.java]
```java
@SpringBootApplication
public class ChatbotSpringApplication {

	public static void main(String[] args) {
		SpringApplication.run(ChatbotSpringApplication.class, args);
	}

}
```
* `@SpringBootApplication` : 하단 3개의 에노테이션을 포함
  * `@EnableAutoConfiguration`: enable Spring Boot’s auto-configuration mechanism
  * `@ComponentScan`: enable @Component scan on the package where the application is located (see the best practices)
  * `@SpringBootConfiguration`: enable registration of extra beans in the context or the import of additional configuration classes. An alternative to Spring’s standard @Configuration that aids configuration detection in your integration tests.

* com.example.project 디렉토리에 Application.java를 하단의 모양으로 생성하여 Root Package로 사용하는 것이 정석
* 이러한 형태로 설정이 되면, `@SpringBootApplication` 에노테이션 설정을 통해 필요한 Bean들을 찾아오는 역할을 수행 

<br>
<hr>
<br>

## @Component
#### 개발자가 직접 개발한 클래스를 Bean으로 등록할 때 사용
#### Class에 선언
#### @Configuration, @Controller, @Service, @Repository... 등등이 모두 @ComponentScan을 통해 가져올 수 있는 Bean 등록 에노테이션

<br>

### [@Component]
```java
@Component
@Scope("singleton")
public class ChatBot {
    int userNum;

    public String sayHello() {
        return String.format("안녕하세요 %d번 손님! 환영합니다!\n", ++userNum);
    }
}
```

### [@Autowired - Constructor 방식]
```java
@Controller
public class ChatBotController {
    
    private final ChatBot ChatBot;

    @Autowired
    public ChatBotController(ChatBot ChatBot) {
        this.ChatBot = ChatBot;
    }
}
```
* `final` : it cannot be subsequently changed

### [@Autowired - Setter 방식]
```java
@Controller
public class ChatBotController {
    
    private ChatBot ChatBot;

    @Autowired
    public void setChatBot(ChatBot ChatBot) {
        this.ChatBot = ChatBot;
    }
}
```

### [@Autowired - 보통 Only @Autowired 방식]
```java
@Controller
public class ChatBotController {
    @Autowired
    private ChatBot ChatBot;
```

<br>
<hr>
<br>

## @Bean
#### 개발자가 직접 제어가 불가능한 라이브러리를 활용할 때, 초기에 설정을 하기 위해 활용할 때 사용
#### Method에 선언

<br>

### [@Bean]
```java
 @Configuration
 public class AppConfig {

     @Bean
     public MyBean myBean() {
     	return new MyBean();
     }
 }
```
* @Configuration
  * 1개 이상의 @Bean을 등록한다는 의미 또한 포함
* @Bean
  * 사용하고자 하는 객체를 반환하는 메소드에 선언
* @Target(value=TYPE)
  * @Retention(value=RUNTIME)
  * @Documented
  * @Component
* 내부에 `@Component` 속성이 있기 때문에, AppConfig 클래스도 Bean으로 IoC Container에 등록됌

<br>

### [ApplicationContext - @Bean 가져오기]
```java
@Controller
public class testController {
  @GetMapping("/")
  public MyBean testBean() {
      ApplicationContext ct = new AnnotationConfigApplicationContext(AppConfig.class); 
      conext.getBean("myBean", MyBean.class);  
  }
}
```
* @Bean(name="")
  * 이름 지정을 안 하면, 자동으로 CamelCase로 변환
