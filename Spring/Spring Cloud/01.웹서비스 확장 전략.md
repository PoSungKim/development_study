# 웹서비스 확장 전략 
> 클라우드 기술은 System Engineer 분야에 대한 기본기 중요
* ```HA```와 ```Resilience```가 주요 개념이며, ```안정적인 분산 처리```도 중요하다

<hr>
<br>

## Scale-up, Scale-out, 블루그린배포

#### 웹서비스 확장 기본 개념

<br>

### [Scale-up & Scale-out]

<div align="center">
  <img width ="50%" src="https://user-images.githubusercontent.com/37537227/118649713-c5ae5b80-b81e-11eb-9332-a95fcb8fb2ee.png">
  <img width ="34%" src="https://user-images.githubusercontent.com/37537227/118649884-f42c3680-b81e-11eb-8619-8c79376ad553.png">
</div>

* Scale-up
  * 하나의 서버의 ```성능 증가```
* Scale-out
  * 하나의 서버를 이미지로 만들어서 그대로 서버 ```하나 더 생성```

<br>

### [블루그린배포]

<div align="center">
  <img width ="50%" src="https://user-images.githubusercontent.com/37537227/118650229-2ccc1000-b81f-11eb-89e7-b2dcda381e05.png">
</div>

* 색깔 
  * 블루 : ```기존``` 서버
  * 그린 : ```새로운``` 서버 (새롭게 패치된 서버)

* ```블루그린배포```
  * ```무중단``` 서버를 위해서, 하나의 블루 서버에 새로운 소스 코드를 넣은 뒤에 다시 재가동하여 그린 서버로 만드는 방식

<br>
<hr>
<br>

## 서버 부하분산을 위한 네트워크

#### 부하 (Load) & 분산 (Balance)

<br>

### [서버 부하 분산을 위한 네트워크]

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118657738-b206f300-b826-11eb-80f8-31a7745d93a6.png">
</div>


* 동그라미 : ```라우터```
* 네모    : ```스위치```
  * ```백본스위치``` : 중계서버 (척추 역할)
  * ```L7스위치```  : Application Layer가 L7, 즉 HTTP 프로토콜을 이해할 수 있는 Layer 
* Zone
  * Trust Zone : ```내부망 (개발망)``` - 운영망 접근 가능, 개발/테스트 환경에서 운영 환경으로 배포가 가능해야 하기 때문
  * DMZ Zone.  : ```외부망 (운영망)```

<br>

### [DNS 및 Host]

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118654310-643cbb80-b823-11eb-9af1-9ead7948df1b.png">
</div>

* ```DNS```  : IP주소는 읽기 어렵기 때문에, ```MyStyle.com``` 처럼 사람이 읽기 편한 주소를 할당받는 것 
* ```Host``` : Scale-out을 통해 다수의 같은 서버가 생성되는데, 구분하기 쉽도록 ```MyStyle1.com, MyStyle2.com, MyStyle3.com``` 처럼 이름을 할당해주는 것
  * ```Windows/System32/drivers/etc/hosts``` 파일에서 설정 가능
  * This file contains the mappings of IP addresses to host names. 
  * "IP Address" "Host Name" 순

<br>

### [DNS와 HTTPS]

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118655891-f1ccdb00-b824-11eb-90fb-ef886584df15.png">
</div>

* ```Wild Card 인증서```
  * ```*.도메인.com```
  * 모든 ```subdomain.domain.com``` 사용 가능
* 보통 ```앞의 WEB 서버에게만 SSL 인증```을 받아서, 보안 이슈를 해결한 뒤에, 뒤의 WAS 서버와 연동하는 형식 (뒤에 위치하기 때문에 보안적으로 안전하다고 함)

<br>

### [Virtual IP]

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118656890-ecbc5b80-b825-11eb-8508-f62ff4029e46.png">
</div>

* ```내부 서버팜```에서는 서버들이 api1, api2, api3이 scale-out되어 있는 상태이고, 외부로 공개되어 있지 않기 때문에, Virtual IP 주소로만 구성되어 있다
  * VIP 스위치가 Load-balancing을 해주는 형식이다

<br>

## 읽기요청 부하 분산

#### Request (쓰기), Response (읽기)라고 대략적으로 표현 가능

<br>

### [서버 부하 분산을 위한 네트워크]

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118658844-bbdd2600-b827-11eb-9c65-b4e325d1dd6d.png">
</div>

* DBMS 서버에 대한 부담을 줄여주기 위해, 앞 서버에 Cache를 포함시켜서 꼭 필요할 때만 DBMS 서버를 호출하게 설계 가능

<div align="center">
  <img width ="80%" src="https://user-images.githubusercontent.com/37537227/118659198-1080a100-b828-11eb-886c-c8e8610d148e.png">
</div>

* 하지만, Cache가 포함되어 있는 서버를 Scale-out하게 되면 각 서버마다 Cache의 내용물이 달라질 수 있기 때문에, 별도의 Cache 서버를 구축하는 설계 또한 가능
